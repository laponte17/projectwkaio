import React, { useState, useEffect } from 'react';
import { 
  Cpu, 
  Bot, 
  Layers, 
  Radio, 
  Eye, 
  Zap, 
  Code2, 
  AlertTriangle, 
  TrendingUp, 
  Server, 
  X,
  CheckCircle2,
  ArrowRight,
  BarChart3
} from 'lucide-react';

// --- Dados dos Produtos ---
const products = [
  {
    id: 1,
    title: "Maestro de Mídia Sintética",
    subtitle: "Orquestrador de Produção End-to-End",
    icon: <Cpu size={32} />,
    category: "SaaS B2B / Enterprise",
    description: "Uma plataforma 'No-Code' que substitui toda a equipe de produção. O usuário digita o tema, a IA gera roteiro, imagens consistentes, narração e entrega o vídeo editado.",
    business: {
      pros: ["Ticket Alto (R$ 297+)", "Resolve a dor da fragmentação de ferramentas", "Alta retenção (Lock-in)"],
      cons: "Custo de infraestrutura (GPUs) pode escalar rápido",
      market: "Canais Dark Profissionais e Agências de Marketing"
    },
    tech: {
      stack: ["Next.js", "n8n Headless", "Python (FastAPI)", "FFmpeg", "Flux API"],
      challenge: "Orquestração de filas assíncronas longas (renderização de vídeo)",
      complexity: 95
    },
    profit: 90
  },
  {
    id: 2,
    title: "Agente de Vendas Audio-First",
    subtitle: "CRM Conversacional Humanizado",
    icon: <Radio size={32} />,
    category: "CRM / Automação WhatsApp",
    description: "Um bot de WhatsApp que não manda apenas texto, mas responde com áudios gerados em tempo real, com pausas e respirações, simulando um humano para vender PLR.",
    business: {
      pros: ["Explosão na taxa de conversão de leads frios", "Diferencial único no mercado BR", "Custo por lead cai drasticamente"],
      cons: "Dependência da API do WhatsApp (Meta) e riscos de bloqueio",
      market: "Infoprodutores e Vendedores de PLR"
    },
    tech: {
      stack: ["Node.js", "OpenAI Realtime API", "Twilio/WPP Connect", "Redis"],
      challenge: "Latência. O áudio precisa ser gerado e enviado em <3 segundos",
      complexity: 70
    },
    profit: 85
  },
  {
    id: 3,
    title: "Continuity Keeper",
    subtitle: "Gerador de Assets Consistentes",
    icon: <Layers size={32} />,
    category: "Micro-SaaS / Ferramenta Criativa",
    description: "Resolve o maior problema da IA atual: inconsistência. Cria Lóras (modelos) on-demand para que o mesmo personagem apareça em 50 cenas diferentes.",
    business: {
      pros: ["Necessidade urgente do mercado", "Fácil de viralizar como ferramenta", "Modelo Freemium viável"],
      cons: "Exige hardware parrudo (GPUs H100/A100) para treino rápido",
      market: "Storytellers, Criadores de HQ e Canais Infantis"
    },
    tech: {
      stack: ["React", "Python", "ComfyUI Backend", "Kohya_ss", "AWS S3"],
      challenge: "Gerenciamento de instâncias GPU e tempo de inferência",
      complexity: 85
    },
    profit: 75
  },
  {
    id: 4,
    title: "Viral Hunter & Remix",
    subtitle: "Inteligência de Dados & Scraper",
    icon: <Bot size={32} />,
    category: "Data SaaS",
    description: "Monitora tendências globais (China/Rússia/EUA), traduz e reescreve roteiros validados para o mercado brasileiro antes que eles cheguem aqui organicamente.",
    business: {
      pros: ["Custo operacional baixíssimo", "Escalabilidade infinita", "Dados são viciantes para o usuário"],
      cons: "Instabilidade constante de scrapers (Gato e Rato com TikTok)",
      market: "Canais de Curiosidades, News e Cortes"
    },
    tech: {
      stack: ["Python (Selenium/Playwright)", "Supabase", "GPT-4 Mini"],
      challenge: "Burlar proteções anti-bot e captchas das redes sociais",
      complexity: 60
    },
    profit: 65
  },
  {
    id: 5,
    title: "Otimizador de Retenção",
    subtitle: "Plugin de Pós-Produção",
    icon: <Eye size={32} />,
    category: "Plugin / Desktop App",
    description: "Analisa o vídeo final e aponta onde a audiência vai sair. Gera legendas dinâmicas e B-Rolls automáticos para preencher buracos visuais.",
    business: {
      pros: ["Venda única ou assinatura barata (Volume)", "Fácil entrada no mercado", "Baixo custo de servidor (processamento local)"],
      cons: "Menor LTV (Lifetime Value) comparado aos outros",
      market: "Editores de Vídeo e Freelancers"
    },
    tech: {
      stack: ["Electron", "React", "OpenCV", "FFmpeg WASM"],
      challenge: "Processamento pesado no lado do cliente (Client-side)",
      complexity: 50
    },
    profit: 55
  }
];

// --- Componentes Visuais ---

const MetricBar = ({ label, value, color }) => (
  <div className="mb-4">
    <div className="flex justify-between mb-1">
      <span className="text-xs font-mono text-slate-400 uppercase">{label}</span>
      <span className="text-xs font-bold text-slate-200">{value}%</span>
    </div>
    <div className="w-full bg-slate-800 rounded-full h-2 overflow-hidden">
      <div 
        className={`h-2 rounded-full ${color} transition-all duration-1000 ease-out`} 
        style={{ width: `${value}%` }}
      ></div>
    </div>
  </div>
);

const TechBadge = ({ children }) => (
  <span className="px-2 py-1 rounded-md bg-slate-800 border border-slate-700 text-xs font-mono text-blue-400 mr-2 mb-2 inline-block hover:border-blue-500 transition-colors cursor-default">
    {children}
  </span>
);

export default function DarkContentPitch() {
  const [selectedProduct, setSelectedProduct] = useState(null);
  const [isLoaded, setIsLoaded] = useState(false);

  useEffect(() => {
    setIsLoaded(true);
  }, []);

  return (
    <div className="min-h-screen bg-[#0a0a0c] text-slate-200 font-sans selection:bg-purple-500 selection:text-white overflow-x-hidden">
      
      {/* Background Gradients */}
      <div className="fixed top-0 left-0 w-full h-full overflow-hidden z-0 pointer-events-none">
        <div className="absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-purple-900/20 rounded-full blur-[120px]"></div>
        <div className="absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-blue-900/20 rounded-full blur-[120px]"></div>
      </div>

      <div className="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        
        {/* Header */}
        <header className={`mb-16 text-center transition-all duration-1000 ${isLoaded ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10'}`}>
          <div className="inline-flex items-center justify-center px-3 py-1 rounded-full bg-slate-900/50 border border-slate-800 mb-6 backdrop-blur-sm">
            <span className="w-2 h-2 rounded-full bg-green-500 mr-2 animate-pulse"></span>
            <span className="text-xs font-mono text-slate-400 tracking-widest">REPORT: GEMINI DARK 2025</span>
          </div>
          <h1 className="text-5xl md:text-7xl font-extrabold tracking-tight mb-6 text-transparent bg-clip-text bg-gradient-to-r from-white via-slate-200 to-slate-500">
            Pipeline de Inovação <br className="hidden md:block" />
            <span className="text-purple-500">Dark Content</span>
          </h1>
          <p className="max-w-2xl mx-auto text-lg text-slate-400 leading-relaxed">
            Análise estratégica de produtos baseada na transição do mercado para <strong className="text-white">Automação Autônoma</strong>.
            <br/>
            Objetivo: Selecionar o MVP de maior impacto para desenvolvimento imediato.
          </p>
        </header>

        {/* Grid de Produtos */}
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-20">
          {products.map((product, index) => (
            <div 
              key={product.id}
              onClick={() => setSelectedProduct(product)}
              className={`group relative bg-slate-900/40 border border-slate-800 hover:border-purple-500/50 rounded-2xl p-6 cursor-pointer transition-all duration-300 hover:-translate-y-2 hover:shadow-2xl hover:shadow-purple-900/10 backdrop-blur-sm flex flex-col justify-between
                ${isLoaded ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-10'}`}
              style={{ transitionDelay: `${index * 100}ms` }}
            >
              <div>
                <div className="flex items-center justify-between mb-4">
                  <div className="p-3 rounded-xl bg-slate-800/50 text-purple-400 group-hover:text-purple-300 group-hover:bg-purple-500/20 transition-colors">
                    {product.icon}
                  </div>
                  <span className="text-[10px] uppercase tracking-wider font-bold text-slate-500 border border-slate-800 px-2 py-1 rounded bg-slate-950">
                    {product.category}
                  </span>
                </div>
                
                <h3 className="text-xl font-bold text-white mb-2 group-hover:text-purple-400 transition-colors">
                  {product.title}
                </h3>
                <p className="text-sm text-slate-400 mb-6 leading-relaxed">
                  {product.description}
                </p>
              </div>

              <div className="mt-auto pt-6 border-t border-slate-800/50">
                <div className="flex items-center justify-between text-sm font-medium text-slate-300 group-hover:text-white">
                  <span>Ver Especificações</span>
                  <ArrowRight size={16} className="group-hover:translate-x-1 transition-transform" />
                </div>
              </div>
            </div>
          ))}
        </div>

        {/* Section de Comparação Rápida */}
        <div className="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center bg-slate-900/30 border border-slate-800 rounded-3xl p-8 md:p-12 backdrop-blur-md">
          <div>
            <h2 className="text-3xl font-bold text-white mb-6">Matriz de Decisão</h2>
            <p className="text-slate-400 mb-8">
              Cruzamento entre complexidade de engenharia e potencial de retorno financeiro imediato.
              O <strong>Maestro</strong> oferece o maior teto, enquanto o <strong>Agente de Vendas</strong> ataca a dor mais aguda (conversão).
            </p>
            <div className="space-y-4">
              <div className="flex items-start">
                <div className="bg-purple-500/10 p-2 rounded-lg mr-4">
                  <TrendingUp className="text-purple-400" size={20} />
                </div>
                <div>
                  <h4 className="font-bold text-white">Maior Potencial de Receita</h4>
                  <p className="text-sm text-slate-500">Maestro de Mídia Sintética (SaaS recorrente)</p>
                </div>
              </div>
              <div className="flex items-start">
                <div className="bg-blue-500/10 p-2 rounded-lg mr-4">
                  <Code2 className="text-blue-400" size={20} />
                </div>
                <div>
                  <h4 className="font-bold text-white">Maior Desafio Técnico</h4>
                  <p className="text-sm text-slate-500">Renderização de vídeo na nuvem (GPU costs)</p>
                </div>
              </div>
            </div>
          </div>
          
          {/* Gráfico Visual CSS */}
          <div className="relative h-64 w-full bg-slate-950/50 rounded-xl border border-slate-800 p-6 flex items-end justify-around">
            <div className="absolute top-4 left-4 text-xs text-slate-600 font-mono">ROI POTENTIAL (Y) vs COMPLEXITY (X)</div>
            
            {products.map((p) => (
              <div key={p.id} className="group relative flex flex-col items-center justify-end h-full w-1/6">
                <div 
                  className="w-full bg-gradient-to-t from-slate-800 to-purple-600/80 rounded-t-md transition-all duration-500 hover:to-purple-400 cursor-help relative"
                  style={{ height: `${p.profit}%`, opacity: 0.6 + (p.tech.complexity / 200) }}
                >
                  {/* Tooltip interno do grafico */}
                  <div className="absolute -top-10 left-1/2 -translate-x-1/2 bg-slate-800 text-xs px-2 py-1 rounded border border-slate-700 opacity-0 group-hover:opacity-100 whitespace-nowrap pointer-events-none transition-opacity z-20">
                    ROI: {p.profit} | Dev: {p.tech.complexity}
                  </div>
                </div>
                <span className="mt-3 text-[10px] text-slate-500 text-center h-8 leading-tight">{p.title.split(' ')[0]}</span>
              </div>
            ))}
          </div>
        </div>

      </div>

      {/* Modal de Detalhes */}
      {selectedProduct && (
        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6">
          <div 
            className="absolute inset-0 bg-black/80 backdrop-blur-sm transition-opacity" 
            onClick={() => setSelectedProduct(null)}
          ></div>
          
          <div className="relative bg-[#0f1115] border border-slate-700 w-full max-w-4xl max-h-[90vh] overflow-y-auto rounded-2xl shadow-2xl shadow-purple-900/20 animate-in fade-in zoom-in duration-300 scrollbar-thin scrollbar-thumb-slate-700 scrollbar-track-transparent">
            
            {/* Modal Header */}
            <div className="sticky top-0 bg-[#0f1115]/95 backdrop-blur-md border-b border-slate-800 p-6 flex items-start justify-between z-10">
              <div className="flex items-center gap-4">
                <div className="p-3 rounded-xl bg-purple-500/10 text-purple-400 border border-purple-500/20">
                  {selectedProduct.icon}
                </div>
                <div>
                  <h2 className="text-2xl font-bold text-white leading-tight">{selectedProduct.title}</h2>
                  <p className="text-sm text-purple-400 font-mono">{selectedProduct.subtitle}</p>
                </div>
              </div>
              <button 
                onClick={() => setSelectedProduct(null)}
                className="p-2 rounded-full hover:bg-slate-800 text-slate-400 hover:text-white transition-colors"
              >
                <X size={24} />
              </button>
            </div>

            <div className="p-6 md:p-8 grid grid-cols-1 md:grid-cols-2 gap-8">
              
              {/* Coluna 1: Business & Vantagens */}
              <div>
                <h3 className="flex items-center text-lg font-bold text-white mb-6">
                  <BarChart3 className="mr-2 text-green-400" size={20} />
                  Visão de Mercado
                </h3>
                
                <div className="space-y-6">
                  <div className="bg-slate-900/50 rounded-xl p-5 border border-slate-800">
                    <h4 className="text-sm font-mono text-slate-500 uppercase mb-3">Vantagens Competitivas</h4>
                    <ul className="space-y-3">
                      {selectedProduct.business.pros.map((pro, idx) => (
                        <li key={idx} className="flex items-start text-sm text-slate-300">
                          <CheckCircle2 className="mr-2 mt-0.5 text-green-500 shrink-0" size={16} />
                          {pro}
                        </li>
                      ))}
                    </ul>
                  </div>

                  <div className="bg-slate-900/50 rounded-xl p-5 border border-slate-800">
                    <h4 className="text-sm font-mono text-slate-500 uppercase mb-3">Ponto de Atenção (Riscos)</h4>
                    <div className="flex items-start text-sm text-slate-300">
                      <AlertTriangle className="mr-2 mt-0.5 text-amber-500 shrink-0" size={16} />
                      {selectedProduct.business.cons}
                    </div>
                  </div>
                </div>
              </div>

              {/* Coluna 2: Tech & Dev */}
              <div>
                <h3 className="flex items-center text-lg font-bold text-white mb-6">
                  <Code2 className="mr-2 text-blue-400" size={20} />
                  Raio-X Técnico
                </h3>

                <div className="bg-slate-900/80 rounded-xl p-6 border border-slate-700 mb-6">
                  <div className="mb-6">
                    <h4 className="text-xs font-mono text-slate-400 uppercase mb-3">Tech Stack Sugerida</h4>
                    <div className="flex flex-wrap">
                      {selectedProduct.tech.stack.map((tech, idx) => (
                        <TechBadge key={idx}>{tech}</TechBadge>
                      ))}
                    </div>
                  </div>

                  <div className="mb-6">
                    <h4 className="text-xs font-mono text-slate-400 uppercase mb-2">Desafio de Engenharia</h4>
                    <p className="text-sm text-slate-300 italic border-l-2 border-blue-500 pl-3">
                      "{selectedProduct.tech.challenge}"
                    </p>
                  </div>

                  <div className="space-y-2">
                    <MetricBar label="Complexidade de Dev" value={selectedProduct.tech.complexity} color="bg-blue-500" />
                    <MetricBar label="Potencial de Lucro" value={selectedProduct.profit} color="bg-green-500" />
                  </div>
                </div>

                <div className="text-center">
                  <p className="text-xs text-slate-500 mb-2">Recomendação para MVP</p>
                  <button className="w-full py-3 rounded-lg bg-purple-600 hover:bg-purple-500 text-white font-bold transition-colors shadow-lg shadow-purple-900/30">
                    Iniciar Especificação Técnica
                  </button>
                </div>
              </div>

            </div>
          </div>
        </div>
      )}
    </div>
  );
}